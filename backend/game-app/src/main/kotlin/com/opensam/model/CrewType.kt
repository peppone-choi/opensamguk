package com.opensam.model

enum class ArmType(val code: Int, val displayName: String) {
    CASTLE(0, "성벽"),
    FOOTMAN(1, "보병"),
    ARCHER(2, "궁병"),
    CAVALRY(3, "기병"),
    WIZARD(4, "귀병"),
    SIEGE(5, "차병"),
}

enum class CrewType(
    val code: Int,
    val displayName: String,
    val armType: ArmType,
    val attack: Int,
    val defence: Int,
    val speed: Int,
    val avoid: Int,
    val magicCoef: Double,
    val cost: Int,
    val riceCost: Int,
    val attackCoef: Map<String, Double> = emptyMap(),
    val defenceCoef: Map<String, Double> = emptyMap(),
    val info: List<String> = emptyList(),
    val initSkillTrigger: List<String> = emptyList(),
    val phaseSkillTrigger: List<String> = emptyList(),
    val iActionList: List<String> = emptyList(),
) {
    // 성벽
    CASTLE(
        1000,
        "성벽",
        ArmType.CASTLE,
        100,
        100,
        7,
        0,
        0.0,
        99,
        9,
        defenceCoef = mapOf("1" to 1.2),
        phaseSkillTrigger = listOf("che_선제사격시도", "che_선제사격발동"),
    ),

    // 보병
    FOOTMAN(
        1100,
        "보병",
        ArmType.FOOTMAN,
        100,
        150,
        7,
        10,
        0.0,
        9,
        9,
        attackCoef = mapOf("2" to 1.2, "3" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("2" to 0.8, "3" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_방어력증가5p"),
    ),
    CHEONGJU(
        1101,
        "청주병",
        ArmType.FOOTMAN,
        100,
        200,
        7,
        10,
        0.0,
        10,
        11,
        attackCoef = mapOf("2" to 1.2, "3" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("2" to 0.8, "3" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_방어력증가5p"),
    ),
    MARINE(
        1102,
        "수병",
        ArmType.FOOTMAN,
        150,
        150,
        7,
        10,
        0.0,
        11,
        10,
        attackCoef = mapOf("2" to 1.2, "3" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("2" to 0.8, "3" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_방어력증가5p"),
    ),
    ASSASSIN(
        1103,
        "자객병",
        ArmType.FOOTMAN,
        100,
        150,
        8,
        20,
        0.0,
        10,
        10,
        attackCoef = mapOf("2" to 1.2, "3" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("2" to 0.8, "3" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_방어력증가5p"),
    ),
    GUARD(
        1104,
        "근위병",
        ArmType.FOOTMAN,
        150,
        200,
        7,
        10,
        0.0,
        12,
        12,
        attackCoef = mapOf("2" to 1.2, "3" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("2" to 0.8, "3" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_방어력증가5p"),
    ),
    RATTAN(
        1105,
        "등갑병",
        ArmType.FOOTMAN,
        100,
        225,
        7,
        5,
        0.0,
        13,
        10,
        attackCoef = mapOf("2" to 1.2, "3" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("2" to 0.8, "3" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_방어력증가5p"),
    ),
    BAEKYI(
        1106,
        "백이병",
        ArmType.FOOTMAN,
        175,
        175,
        7,
        5,
        0.0,
        13,
        11,
        attackCoef = mapOf("2" to 1.1, "3" to 0.9, "5" to 1.1),
        defenceCoef = mapOf("2" to 0.9, "3" to 1.1, "5" to 0.9),
        phaseSkillTrigger = listOf("che_방어력증가5p"),
    ),

    // 궁병
    ARCHER(
        1200,
        "궁병",
        ArmType.ARCHER,
        100,
        100,
        7,
        10,
        0.0,
        10,
        10,
        attackCoef = mapOf("3" to 1.2, "1" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("3" to 0.8, "1" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_선제사격시도", "che_선제사격발동"),
    ),
    MOUNTED_ARCHER(
        1201,
        "궁기병",
        ArmType.ARCHER,
        100,
        100,
        8,
        20,
        0.0,
        11,
        12,
        attackCoef = mapOf("3" to 1.2, "1" to 0.9, "5" to 1.2),
        defenceCoef = mapOf("3" to 0.8, "1" to 1.1, "5" to 0.8),
        phaseSkillTrigger = listOf("che_선제사격시도", "che_선제사격발동"),
    ),
    CROSSBOW(
        1202,
        "연노병",
        ArmType.ARCHER,
        150,
        100,
        8,
        10,
        0.0,
        12,
        11,
        attackCoef = mapOf("3" to 1.2, "1" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("3" to 0.8, "1" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_선제사격시도", "che_선제사격발동"),
    ),
    LONGBOW(
        1203,
        "강궁병",
        ArmType.ARCHER,
        150,
        150,
        7,
        10,
        0.0,
        13,
        13,
        attackCoef = mapOf("3" to 1.2, "1" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("3" to 0.8, "1" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_선제사격시도", "che_선제사격발동"),
    ),
    STONE_CROSSBOW(
        1204,
        "석궁병",
        ArmType.ARCHER,
        200,
        100,
        7,
        10,
        0.0,
        13,
        13,
        attackCoef = mapOf("3" to 1.2, "1" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("3" to 0.8, "1" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_선제사격시도", "che_선제사격발동"),
    ),

    // 기병
    CAVALRY(
        1300,
        "기병",
        ArmType.CAVALRY,
        150,
        100,
        7,
        5,
        0.0,
        11,
        11,
        attackCoef = mapOf("1" to 1.2, "2" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("1" to 0.8, "2" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_기병병종전투"),
    ),
    WHITE_HORSE(
        1301,
        "백마병",
        ArmType.CAVALRY,
        200,
        100,
        7,
        5,
        0.0,
        12,
        13,
        attackCoef = mapOf("1" to 1.2, "2" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("1" to 0.8, "2" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_기병병종전투"),
    ),
    HEAVY_CAVALRY(
        1302,
        "중장기병",
        ArmType.CAVALRY,
        150,
        150,
        7,
        5,
        0.0,
        13,
        12,
        attackCoef = mapOf("1" to 1.2, "2" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("1" to 0.8, "2" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_기병병종전투"),
    ),
    CHARGE_CAVALRY(
        1303,
        "돌격기병",
        ArmType.CAVALRY,
        200,
        100,
        8,
        5,
        0.0,
        13,
        11,
        attackCoef = mapOf("1" to 1.2, "2" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("1" to 0.8, "2" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_기병병종전투"),
    ),
    IRON_CAVALRY(
        1304,
        "철기병",
        ArmType.CAVALRY,
        100,
        250,
        7,
        5,
        0.0,
        11,
        13,
        attackCoef = mapOf("1" to 1.2, "2" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("1" to 0.8, "2" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_기병병종전투"),
    ),
    HUNTER_CAVALRY(
        1305,
        "수렵기병",
        ArmType.CAVALRY,
        150,
        100,
        8,
        15,
        0.0,
        12,
        12,
        attackCoef = mapOf("1" to 1.2, "2" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("1" to 0.8, "2" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_기병병종전투"),
    ),
    BEAST(
        1306,
        "맹수병",
        ArmType.CAVALRY,
        250,
        175,
        6,
        0,
        0.0,
        16,
        16,
        attackCoef = mapOf("1" to 1.2, "2" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("1" to 0.8, "2" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_기병병종전투"),
    ),
    TIGER_CAVALRY(
        1307,
        "호표기병",
        ArmType.CAVALRY,
        200,
        150,
        7,
        5,
        0.0,
        14,
        14,
        attackCoef = mapOf("1" to 1.2, "2" to 0.8, "5" to 1.2),
        defenceCoef = mapOf("1" to 0.8, "2" to 1.2, "5" to 0.8),
        phaseSkillTrigger = listOf("che_기병병종전투"),
    ),

    // 귀병
    WIZARD(1400, "귀병", ArmType.WIZARD, 80, 80, 7, 5, 0.5, 9, 9, attackCoef = mapOf("5" to 1.2), defenceCoef = mapOf("5" to 0.8)),
    DIVINE_WIZARD(1401, "신귀병", ArmType.WIZARD, 80, 80, 7, 20, 0.6, 10, 10, attackCoef = mapOf("5" to 1.2), defenceCoef = mapOf("5" to 0.8)),
    WHITE_WIZARD(1402, "백귀병", ArmType.WIZARD, 80, 130, 7, 5, 0.6, 9, 11, attackCoef = mapOf("5" to 1.2), defenceCoef = mapOf("5" to 0.8)),
    BLACK_WIZARD(1403, "흑귀병", ArmType.WIZARD, 130, 80, 7, 5, 0.6, 11, 9, attackCoef = mapOf("5" to 1.2), defenceCoef = mapOf("5" to 0.8)),
    EVIL_WIZARD(1404, "악귀병", ArmType.WIZARD, 130, 130, 7, 0, 0.6, 12, 12, attackCoef = mapOf("5" to 1.2), defenceCoef = mapOf("5" to 0.8)),
    SOUTH_WIZARD(1405, "남귀병", ArmType.WIZARD, 60, 60, 7, 10, 0.8, 8, 8, attackCoef = mapOf("5" to 1.2), defenceCoef = mapOf("5" to 0.8)),
    YELLOW_WIZARD(1406, "황귀병", ArmType.WIZARD, 110, 110, 7, 0, 0.8, 13, 10, attackCoef = mapOf("5" to 1.2), defenceCoef = mapOf("5" to 0.8)),
    HEAVEN_WIZARD(1407, "천귀병", ArmType.WIZARD, 80, 130, 7, 15, 0.6, 11, 12, attackCoef = mapOf("5" to 1.2), defenceCoef = mapOf("5" to 0.8)),
    DEMON_WIZARD(1408, "마귀병", ArmType.WIZARD, 130, 80, 7, 15, 0.6, 12, 11, attackCoef = mapOf("5" to 1.2), defenceCoef = mapOf("5" to 0.8)),

    // 차병(공성)
    JEONGRAN(
        1500,
        "정란",
        ArmType.SIEGE,
        100,
        100,
        6,
        0,
        0.0,
        14,
        5,
        attackCoef = mapOf("1" to 1.25, "2" to 1.25, "3" to 1.25, "4" to 1.25, "0" to 1.8, "1106" to 1.112),
        defenceCoef = mapOf("1" to 1.2, "2" to 1.2, "3" to 1.2, "4" to 1.2, "1106" to 1.067),
        initSkillTrigger = listOf("che_성벽부상무효"),
        phaseSkillTrigger = listOf("che_선제사격시도", "che_선제사격발동"),
        iActionList = listOf("che_성벽선제"),
    ),
    RAM(
        1501,
        "충차",
        ArmType.SIEGE,
        150,
        100,
        6,
        0,
        0.0,
        18,
        5,
        attackCoef = mapOf("1" to 0.8, "2" to 0.8, "3" to 0.8, "4" to 0.8, "0" to 2.4),
        defenceCoef = mapOf("1" to 1.2, "2" to 1.2, "3" to 1.2, "4" to 1.2),
        initSkillTrigger = listOf("che_성벽부상무효"),
    ),
    CATAPULT(
        1502,
        "벽력거",
        ArmType.SIEGE,
        150,
        100,
        6,
        5,
        0.0,
        20,
        5,
        attackCoef = mapOf("1" to 1.25, "2" to 1.25, "3" to 1.25, "4" to 1.25, "0" to 1.8, "1106" to 1.112),
        defenceCoef = mapOf("1" to 1.2, "2" to 1.2, "3" to 1.2, "4" to 1.2, "1106" to 1.067),
        initSkillTrigger = listOf("che_성벽부상무효"),
        phaseSkillTrigger = listOf("che_선제사격시도", "che_선제사격발동"),
        iActionList = listOf("che_성벽선제"),
    ),
    WOODEN_OX(
        1503,
        "목우",
        ArmType.SIEGE,
        50,
        200,
        5,
        0,
        0.0,
        15,
        5,
        attackCoef = mapOf("1" to 1.0, "2" to 1.0, "3" to 1.0, "4" to 1.0, "0" to 1.8),
        defenceCoef = mapOf("1" to 1.0, "2" to 1.0, "3" to 1.0, "4" to 1.0, "1106" to 1.0),
        initSkillTrigger = listOf("che_성벽부상무효"),
        phaseSkillTrigger = listOf("che_저지시도", "che_저지발동"),
    );

    fun getAttackCoef(opponent: CrewType): Double {
        return attackCoef[opponent.code.toString()]
            ?: attackCoef[opponent.armType.code.toString()]
            ?: 1.0
    }

    fun getDefenceCoef(opponent: CrewType): Double {
        return defenceCoef[opponent.code.toString()]
            ?: defenceCoef[opponent.armType.code.toString()]
            ?: 1.0
    }

    fun getShortName(): String = if (displayName.length <= 4) displayName else displayName.take(4)

    companion object {
        private val byCode = entries.associateBy { it.code }

        fun fromCode(code: Int): CrewType? = byCode[code]
    }
}
